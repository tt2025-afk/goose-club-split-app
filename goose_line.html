<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éµéµä¿±æ¨‚éƒ¨-åˆ†å¸³ç¶²é </title>
    <style>
        :root {
            --primary-color: #4a90e2; /* æŸ”å’Œè— */
            --accent-color: #50c878;  /* ç¿¡ç¿ ç¶  (è¤‡è£½æŒ‰éˆ•) */
            --danger-color: #ff6b6b;  /* æŸ”å’Œç´… (åˆªé™¤/è² å‚µ) */
            --bg-color: #f4f7f9;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-radius: 12px;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        h2 {
            font-size: 1.2rem;
            color: #555;
            border-left: 5px solid var(--primary-color);
            padding-left: 10px;
            margin-top: 0;
        }

        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        /* è¼¸å…¥æ¡†æ¨£å¼ */
        input[type="text"], input[type="number"], select {
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            font-size: 1rem;
            transition: border 0.3s;
        }

        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 30px; /* è† å›Šç‹€æŒ‰éˆ• */
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 10px;
            font-size: 0.95rem;
        }

        #addMemberBtn, #addExpenseBtn {
            background-color: var(--primary-color);
            color: white;
            width: 100%;
        }
        
        #addMemberBtn:hover, #addExpenseBtn:hover {
            background-color: #357abd;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.3);
        }

        #cancelEditBtn {
            background-color: #95a5a6;
            color: white;
            width: 100%;
        }

        /* å°æŒ‰éˆ• */
        .member-action-btn, .expense-action-btn {
            padding: 5px 12px;
            margin-left: 5px;
            font-size: 0.85rem;
            border-radius: 6px;
        }

        .edit-btn { background-color: #f1c40f; color: #fff; }
        .edit-btn:hover { background-color: #d4ac0d; }

        .delete-btn { background-color: var(--danger-color); color: white; }
        .delete-btn:hover { background-color: #e55050; }

        /* è¤‡è£½åˆ° LINE æŒ‰éˆ• */
        #copyToLineBtn {
            background-color: #06c755; /* LINE çš„ç¶ è‰² */
            color: white;
            width: 100%;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        #copyToLineBtn:hover {
            background-color: #05b34c;
            box-shadow: 0 4px 12px rgba(6, 199, 85, 0.3);
        }

        /* è¡¨æ ¼æ¨£å¼ */
        table {
            width: 100%;
            border-collapse: separate; 
            border-spacing: 0;
            margin-top: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        tr:last-child td { border-bottom: none; }
        tr:nth-child(even) { background-color: #fafbfc; } /* æ–‘é¦¬ç´‹ */

        /* ç‹€æ…‹é¡è‰² */
        .net-positive { color: #2ecc71; font-weight: bold; }
        .net-negative { color: var(--danger-color); font-weight: bold; }

        /* Checkbox æ¨£å¼ */
        .split-checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
            padding: 10px;
            background: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .split-checkbox-group label {
            display: inline-flex;
            align-items: center;
            background-color: #fff;
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            user-select: none;
        }

        .split-checkbox-group label:hover {
            background-color: #f0f4ff;
            border-color: var(--primary-color);
        }

        .split-checkbox-group input { margin-right: 6px; }

        #selectAllLabel {
            background-color: #e8f5e9 !important;
            color: #2e7d32;
            border-color: #c8e6c9 !important;
            font-weight: bold;
        }

        .member-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px dashed #eee;
        }
        .member-item:last-child { border-bottom: none; }

        /* æç¤ºè¨Šæ¯ */
        .warning-text {
            color: #999;
            font-size: 0.85rem;
            text-align: center;
            margin-top: 10px;
        }
        
        /* çµç®—å»ºè­°å€å¡Š */
        #settlementSuggestions {
            background-color: #fffbe6;
            border: 1px solid #ffe58f;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        #settlementSuggestions p {
            margin: 5px 0;
            font-size: 1rem;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ¦¢ éµéµä¿±æ¨‚éƒ¨ åˆ†å¸³</h1>

    <div class="card">
        <h2>1. æˆå“¡è¨­å®š</h2>
        <div style="display: flex; gap: 10px;">
            <input type="text" id="memberInput" placeholder="è¼¸å…¥æˆå“¡åç¨±..." style="flex: 1;">
        </div>
        <button id="addMemberBtn">ï¼‹ æ–°å¢æˆå“¡</button>
        
        <div style="margin-top: 20px;">
            <h3 style="font-size: 1rem; color: #777; margin-bottom: 10px;">ç•¶å‰æˆå“¡åˆ—è¡¨:</h3>
            <div id="memberList" style="border: 1px solid #eee; border-radius: 8px; padding: 5px;"></div>
        </div>
        <p class="warning-text">* æ³¨æ„ï¼šåˆªé™¤æˆ–ç·¨è¼¯æˆå“¡åç¨±å°‡æ¸…ç©ºæ‰€æœ‰æ”¯å‡ºç´€éŒ„ã€‚</p>
    </div>

    <div class="card">
        <h2>2. è¨˜éŒ„æ”¯å‡º</h2>
        <label style="font-weight:bold; display:block; margin-top:10px;">é …ç›®èªªæ˜</label>
        <input type="text" id="expenseName" placeholder="ä¾‹å¦‚: æ™šé¤ã€é£²æ–™...">
        
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 200px;">
                <label style="font-weight:bold; display:block; margin-top:10px;">é‡‘é¡ (è‡ªå‹•å–æ•´æ•¸)</label>
                <input type="number" id="expenseAmount" placeholder="$" min="0" step="1">
            </div>
            <div style="flex: 1; min-width: 200px;">
                <label style="font-weight:bold; display:block; margin-top:10px;">èª°å…ˆä»˜çš„ï¼Ÿ</label>
                <select id="paidBy"></select>
            </div>
        </div>

        <label style="font-weight:bold; display:block; margin-top:15px;">åˆ†çµ¦èª°ï¼Ÿ</label>
        <div id="splitMembersContainer" class="split-checkbox-group">
            <p id="noMembersMsg" style="color: orange;">è«‹å…ˆæ–°å¢æˆå“¡æ‰èƒ½è¨˜éŒ„æ”¯å‡ºï¼</p>
        </div>
        
        <button id="addExpenseBtn">ğŸ’¾ è¨˜éŒ„é€™ç­†æ”¯å‡º</button>
        <button id="cancelEditBtn" style="display:none;">å–æ¶ˆç·¨è¼¯</button>

        <h3 style="margin-top: 25px; border-bottom: 1px solid #eee; padding-bottom: 5px;">ğŸ“œ æ”¯å‡ºæ­·å²</h3>
        <div style="overflow-x: auto;">
            <table id="expenseTable">
                <thead>
                    <tr>
                        <th>èªªæ˜</th>
                        <th>é‡‘é¡</th>
                        <th>ä»˜æ¬¾äºº</th>
                        <th>åˆ†æ”¤äºº</th>
                        <th style="width: 130px;">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="expenseTbody"> 
                </tbody>
            </table>
        </div>
    </div>

    <div class="card">
        <h2>3. çµç®—çµæœèˆ‡å»ºè­°</h2>
        
        <h3 style="font-size: 1.1rem;">ğŸ’° æˆå“¡æ·¨é¡ç‹€æ³</h3>
        <div style="overflow-x: auto;">
            <table id="netTable">
                <thead>
                    <tr>
                        <th>æˆå“¡</th>
                        <th>æ·¨é¡</th>
                        <th>ç‹€æ…‹</th>
                    </tr>
                </thead>
                <tbody id="netTbody">
                </tbody>
            </table>
        </div>

        <h3 style="font-size: 1.1rem; margin-top: 30px;">ğŸ’¡ æœ€ä½³è½‰å¸³å»ºè­°</h3>
        <div id="settlementSuggestions">
        </div>

        <button id="copyToLineBtn" style="margin-top: 20px;">
            ğŸ“‹ è¤‡è£½çµæœ (æ–‡å­—)
        </button>
    </div>
</div>

<script>
    // æ ¸å¿ƒæ•¸æ“šçµæ§‹ (é è¨­æˆå“¡)
    let members = ["è˜‹æœ", "å¤§å“¥", "å°æ¯›", "ç¿”å“¥", "çƒé¾œ", "è€€å“¥", "èŠ‹åœ“", "å¯§å¯§", "ç¬¨è›‹"]; 
    let expenses = []; 
    let currentlyEditingIndex = null; 

    // --- åˆå§‹åŒ– ---
    document.addEventListener('DOMContentLoaded', () => {
        // ç¶å®šæŒ‰éˆ•
        document.getElementById('addMemberBtn').addEventListener('click', addMember);
        document.getElementById('addExpenseBtn').addEventListener('click', addExpense);
        document.getElementById('cancelEditBtn').addEventListener('click', resetExpenseForm);
        document.getElementById('copyToLineBtn').addEventListener('click', copyToLine);

        // äº‹ä»¶å§”æ´¾ (è™•ç†å‹•æ…‹ç”Ÿæˆçš„å…ƒç´ )
        document.addEventListener('click', (event) => {
            const target = event.target;
            
            // æˆå“¡æ“ä½œ
            if (target.matches('[data-action="edit-member"]')) {
                editMember(parseInt(target.dataset.index, 10), target.dataset.name);
            } else if (target.matches('[data-action="delete-member"]')) {
                deleteMember(parseInt(target.dataset.index, 10), target.dataset.name);
            }

            // æ”¯å‡ºæ“ä½œ
            else if (target.matches('[data-action="edit-expense"]')) {
                editExpense(parseInt(target.dataset.index, 10));
            } else if (target.matches('[data-action="delete-expense"]')) {
                deleteExpense(parseInt(target.dataset.index, 10));
            }
        });
        
        // ç›£è½ Checkbox
        document.addEventListener('change', (event) => {
            const target = event.target;
            if (target.matches('[data-action="toggleAll"]')) {
                toggleAllSplitMembers(target.checked);
            } else if (target.matches('[data-action="checkMember"]')) {
                updateSelectAllCheckbox();
            }
        });

        // åˆå§‹è¼‰å…¥
        updateUI();
        calculateAndDisplaySettlement();
    });

    // --- UI æ›´æ–° ---
    function updateUI() {
        displayMemberList();
        populatePaidBySelect();
        populateSplitMembersCheckboxes();
        displayExpenses();
    }
    
    // --- æˆå“¡ç®¡ç† ---
    function addMember() {
        const input = document.getElementById('memberInput');
        const name = input.value.trim();
        if (name && !members.includes(name)) {
            members.push(name); 
            input.value = '';
            updateUI(); 
            calculateAndDisplaySettlement();
        } else if (name) {
            alert('æˆå“¡åç¨±å·²å­˜åœ¨æˆ–ç‚ºç©ºï¼');
        }
    }

    function displayMemberList() {
        const listDiv = document.getElementById('memberList');
        listDiv.innerHTML = members.map((m, index) => `
            <div class="member-item">
                <span style="font-weight:500;">${m}</span>
                <div>
                    <button class="member-action-btn edit-btn" data-action="edit-member" data-index="${index}" data-name="${m}">ç·¨è¼¯</button>
                    <button class="member-action-btn delete-btn" data-action="delete-member" data-index="${index}" data-name="${m}">åˆªé™¤</button>
                </div>
            </div>
        `).join('');
    }

    function editMember(index, oldName) {
        const newName = prompt(`è«‹è¼¸å…¥ ${oldName} çš„æ–°åç¨±:`, oldName);
        if (newName && newName.trim() !== oldName && !members.includes(newName.trim())) {
            if (!confirm(`è­¦å‘Šï¼šç·¨è¼¯æˆå“¡åç¨±å°‡æ¸…é™¤æ‰€æœ‰æ”¯å‡ºç´€éŒ„ã€‚æ˜¯å¦ç¹¼çºŒï¼Ÿ`)) return;
            members[index] = newName.trim();
            expenses = []; 
            updateUI();
            calculateAndDisplaySettlement();
        }
    }

    function deleteMember(index, nameToDelete) {
        if (confirm(`è­¦å‘Šï¼šåˆªé™¤æˆå“¡ ${nameToDelete} æœƒæ¸…é™¤æ‰€æœ‰æ”¯å‡ºç´€éŒ„ã€‚æ˜¯å¦ç¹¼çºŒï¼Ÿ`)) {
            members.splice(index, 1);
            expenses = []; 
            updateUI();
            calculateAndDisplaySettlement();
        }
    }

    // --- æ”¯å‡ºç®¡ç† ---
    function populatePaidBySelect() {
        const select = document.getElementById('paidBy');
        select.innerHTML = members.map(m => `<option value="${m}">${m}</option>`).join('');
    }

    function populateSplitMembersCheckboxes() {
        const container = document.getElementById('splitMembersContainer');
        const noMembersMsg = document.getElementById('noMembersMsg');
        
        if (members.length === 0) {
            container.innerHTML = '';
            noMembersMsg.style.display = 'block';
            return;
        }
        noMembersMsg.style.display = 'none';
        
        let checkboxesHtml = `
            <label id="selectAllLabel">
                <input type="checkbox" id="selectAll" data-action="toggleAll" checked> 
                å…¨é¸
            </label>
        `;
        checkboxesHtml += members.map(m => `
            <label>
                <input type="checkbox" name="splitMember" value="${m}" data-action="checkMember" checked> 
                ${m}
            </label>
        `).join('');
        container.innerHTML = checkboxesHtml;
    }

    function toggleAllSplitMembers(checked) {
        document.querySelectorAll('input[name="splitMember"]').forEach(cb => cb.checked = checked);
        updateSelectAllCheckbox();
    }

    function updateSelectAllCheckbox() {
        const all = document.querySelectorAll('input[name="splitMember"]');
        const checked = Array.from(all).filter(cb => cb.checked).length;
        const selectAllCb = document.getElementById('selectAll');
        if(selectAllCb) selectAllCb.checked = (checked === all.length && all.length > 0);
    }

    function addExpense() {
        if (members.length === 0) { alert('è«‹å…ˆæ–°å¢æˆå“¡ï¼'); return; }
        
        const name = document.getElementById('expenseName').value.trim();
        const amount = Math.floor(parseFloat(document.getElementById('expenseAmount').value)); // æ•´æ•¸
        const paidBy = document.getElementById('paidBy').value;
        const splitCheckboxes = Array.from(document.querySelectorAll('input[name="splitMember"]:checked'))
                                     .filter(cb => cb.id !== 'selectAll');
        const splitAmong = splitCheckboxes.map(cb => cb.value);

        if (!name || isNaN(amount) || amount <= 0 || !paidBy || splitAmong.length === 0) {
            alert('è«‹ç¢ºèªè³‡æ–™å®Œæ•´ (é‡‘é¡éœ€ > 0)ï¼Œä¸”è‡³å°‘æœ‰ä¸€äººåˆ†æ”¤ï¼');
            return;
        }
        
        const newExpense = { name, amount, paidBy, splitAmong };

        if (currentlyEditingIndex !== null) {
            expenses[currentlyEditingIndex] = newExpense;
        } else {
            expenses.push(newExpense);
        }

        resetExpenseForm(); 
        displayExpenses();
        calculateAndDisplaySettlement();
    }

    function deleteExpense(index) {
        if (confirm(`ç¢ºå®šè¦åˆªé™¤ "${expenses[index].name}" å—ï¼Ÿ`)) {
            expenses.splice(index, 1); 
            displayExpenses();
            calculateAndDisplaySettlement();
        }
    }

    function editExpense(index) {
        currentlyEditingIndex = index;
        const exp = expenses[index];
        document.getElementById('expenseName').value = exp.name;
        document.getElementById('expenseAmount').value = exp.amount;
        document.getElementById('paidBy').value = exp.paidBy;

        const checkboxes = document.querySelectorAll('input[name="splitMember"]');
        checkboxes.forEach(cb => cb.checked = exp.splitAmong.includes(cb.value));
        updateSelectAllCheckbox();

        document.getElementById('addExpenseBtn').innerText = 'ğŸ’¾ å„²å­˜è®Šæ›´';
        document.getElementById('cancelEditBtn').style.display = 'inline-block';
        document.getElementById('expenseName').focus();
    }
    
    function resetExpenseForm() {
        currentlyEditingIndex = null; 
        document.getElementById('expenseName').value = '';
        document.getElementById('expenseAmount').value = '';
        
        // æ¢å¾©å…¨é¸
        const checkboxes = document.querySelectorAll('input[name="splitMember"]');
        checkboxes.forEach(cb => cb.checked = true);
        updateSelectAllCheckbox();

        document.getElementById('addExpenseBtn').innerText = 'ğŸ’¾ è¨˜éŒ„é€™ç­†æ”¯å‡º';
        document.getElementById('cancelEditBtn').style.display = 'none';
    }

    function displayExpenses() {
        const tbody = document.getElementById('expenseTbody');
        if (expenses.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #999; padding: 20px;">ç›®å‰æ²’æœ‰æ”¯å‡ºç´€éŒ„ ğŸƒ</td></tr>';
        } else {
            tbody.innerHTML = expenses.map((exp, index) => `
                <tr>
                    <td>${exp.name}</td>
                    <td style="font-weight:bold;">$${exp.amount}</td>
                    <td>${exp.paidBy}</td>
                    <td style="font-size:0.85rem; color:#666;">${exp.splitAmong.length}äººåˆ†: ${exp.splitAmong.join(', ')}</td>
                    <td>
                        <button class="expense-action-btn edit-btn" data-action="edit-expense" data-index="${index}">ä¿®</button>
                        <button class="expense-action-btn delete-btn" data-action="delete-expense" data-index="${index}">åˆª</button>
                    </td>
                </tr>
            `).join('');
        }
    }

    // --- æ ¸å¿ƒè¨ˆç®— ---
    function calculateAndDisplaySettlement() {
        const netAmounts = {};
        members.forEach(m => netAmounts[m] = 0);
        
        expenses.forEach(exp => {
            const splitCount = exp.splitAmong.length;
            if (splitCount === 0) return;
            
            // æ•´æ•¸å…¬å¹³åˆ†å¸³
            netAmounts[exp.paidBy] += exp.amount;
            const baseShare = Math.floor(exp.amount / splitCount);
            const remainder = exp.amount % splitCount;

            exp.splitAmong.forEach((member, index) => {
                let share = baseShare + (index < remainder ? 1 : 0);
                netAmounts[member] -= share;
            });
        });

        displayNetAmounts(netAmounts); 
        return calculateSettlements(netAmounts); // å›å‚³çµæœä¾›è¤‡è£½ä½¿ç”¨
    }

    function displayNetAmounts(netAmounts) {
        const tbody = document.getElementById('netTbody');
        tbody.innerHTML = '';
        
        if (members.length === 0) {
             tbody.innerHTML = '<tr><td colspan="3" style="text-align:center;">è«‹å…ˆæ–°å¢æˆå“¡</td></tr>';
             return;
        }

        members.forEach(member => {
            const net = netAmounts[member];
            const statusClass = net > 0 ? 'net-positive' : (net < 0 ? 'net-negative' : '');
            const statusText = net > 0 ? 'æ‡‰æ”¶' : (net < 0 ? 'æ‡‰ä»˜' : 'çµæ¸…');
            const row = `
                <tr>
                    <td>${member}</td>
                    <td class="${statusClass}">$${Math.abs(net)}</td> 
                    <td>${statusText}</td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    }

    function calculateSettlements(netAmounts) {
        const suggestionsDiv = document.getElementById('settlementSuggestions');
        const balances = Object.entries(netAmounts)
            .filter(([, net]) => net !== 0)
            .sort((a, b) => a[1] - b[1]); 

        let i = 0; 
        let j = balances.length - 1; 
        const settlements = [];
        
        while (i < j) {
            const debtor = balances[i][0];
            const creditor = balances[j][0]; 
            const amount = Math.min(balances[j][1], -balances[i][1]);

            if (amount > 0) settlements.push({ from: debtor, to: creditor, amount: amount });
            
            balances[i][1] += amount; 
            balances[j][1] -= amount; 
            
            if (balances[i][1] === 0) i++;
            if (balances[j][1] === 0) j--;
        }
        
        if (settlements.length === 0) {
            const msg = (members.length > 0 && expenses.length > 0) ? 'ğŸ‰ å¤§å®¶éƒ½çµæ¸…å›‰ï¼' : 'å°šç„¡è³‡æ–™';
            suggestionsDiv.innerHTML = `<p style="text-align:center; color:#2ecc71; font-weight:bold;">${msg}</p>`;
            return [];
        } else {
            suggestionsDiv.innerHTML = settlements.map(s => 
                `<p>ğŸ‘‰ <strong>${s.from}</strong> çµ¦ <strong>${s.to}</strong>ï¼š <span style="color:#e55050; font-weight:bold;">$${s.amount}</span></p>`
            ).join('');
            return settlements;
        }
    }

    // --- è¤‡è£½åˆ° LINE ---
    function copyToLine() {
        // é‡æ–°è¨ˆç®—ä»¥ç²å–æœ€æ–°æ•¸æ“š
        const netAmounts = {};
        members.forEach(m => netAmounts[m] = 0);
        expenses.forEach(exp => {
            const splitCount = exp.splitAmong.length;
            if (splitCount === 0) return;
            netAmounts[exp.paidBy] += exp.amount;
            const baseShare = Math.floor(exp.amount / splitCount);
            const remainder = exp.amount % splitCount;
            exp.splitAmong.forEach((member, index) => {
                let share = baseShare + (index < remainder ? 1 : 0);
                netAmounts[member] -= share;
            });
        });

        const settlements = calculateSettlements(netAmounts); // å–å¾—è½‰å¸³åˆ—è¡¨
        
        // ç”¢ç”Ÿæ–‡å­—
        let text = "ğŸ¦¢ éµéµä¿±æ¨‚éƒ¨ - åˆ†å¸³çµæœ\n";
        text += "====================\n\n";
        
        if (settlements.length === 0) {
            text += "ğŸ‰ ç›®å‰æ²’æœ‰éœ€è¦è½‰å¸³çš„æ¬¾é …ï¼\n";
        } else {
            settlements.forEach(s => {
                text += `ğŸ‘‰ ${s.from} çµ¦ ${s.to}: $${s.amount}\n`;
            });
            text += "\nğŸ’° è¨˜å¾—è½‰å¸³å–”ï¼\n";
        }
        
        text += "\n====================\n";
        text += `å…± ${expenses.length} ç­†æ”¯å‡ºç´€éŒ„`;

        // åŸ·è¡Œè¤‡è£½
        navigator.clipboard.writeText(text).then(() => {
            alert("âœ… å·²è¤‡è£½çµæœï¼\nè«‹ç›´æ¥åˆ° LINE è²¼ä¸Šå³å¯ã€‚");
        }).catch(err => {
            console.error('è¤‡è£½å¤±æ•—:', err);
            alert("âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ã€‚");
        });
    }
</script>

</body>
</html>